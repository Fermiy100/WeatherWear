<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>WeatherWear - Умный гардероб</title>
    <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>☁️</text></svg>">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            min-height: 100vh;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            transition: background 0.8s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 20px;
            position: relative;
            overflow-x: hidden;
        }

        /* Анимированные фоны */
        body.cold { 
            background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
            animation: coldPulse 4s ease-in-out infinite;
        }
        body.cool { 
            background: linear-gradient(135deg, #a8edea 0%, #fed6e3 100%);
            animation: coolFlow 6s ease-in-out infinite;
        }
        body.mild { 
            background: linear-gradient(135deg, #ffecd2 0%, #fcb69f 100%);
            animation: mildGlow 5s ease-in-out infinite;
        }
        body.warm { 
            background: linear-gradient(135deg, #ff9a9e 0%, #fecfef 100%);
            animation: warmWave 4s ease-in-out infinite;
        }
        body.hot { 
            background: linear-gradient(135deg, #ffecd2 0%, #fcb69f 100%);
            animation: hotPulse 3s ease-in-out infinite;
        }

        @keyframes coldPulse {
            0%, 100% { background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%); }
            50% { background: linear-gradient(135deg, #00f2fe 0%, #4facfe 100%); }
        }

        @keyframes coolFlow {
            0%, 100% { background: linear-gradient(135deg, #a8edea 0%, #fed6e3 100%); }
            50% { background: linear-gradient(135deg, #fed6e3 0%, #a8edea 100%); }
        }

        @keyframes mildGlow {
            0%, 100% { background: linear-gradient(135deg, #ffecd2 0%, #fcb69f 100%); }
            50% { background: linear-gradient(135deg, #fcb69f 0%, #ffecd2 100%); }
        }

        @keyframes warmWave {
            0%, 100% { background: linear-gradient(135deg, #ff9a9e 0%, #fecfef 100%); }
            50% { background: linear-gradient(135deg, #fecfef 0%, #ff9a9e 100%); }
        }

        @keyframes hotPulse {
            0%, 100% { background: linear-gradient(135deg, #ffecd2 0%, #fcb69f 100%); }
            50% { background: linear-gradient(135deg, #fcb69f 0%, #ffecd2 100%); }
        }

        .container {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(15px);
            border-radius: 25px;
            padding: 40px;
            box-shadow: 0 25px 50px rgba(0, 0, 0, 0.15);
            max-width: 650px;
            width: 100%;
            text-align: center;
            animation: slideIn 0.8s ease-out;
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateY(40px) scale(0.95);
            }
            to {
                opacity: 1;
                transform: translateY(0) scale(1);
            }
        }

        h1 {
            color: #2c3e50;
            font-size: 2.8rem;
            margin-bottom: 10px;
            font-weight: 700;
            text-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }

        .subtitle {
            color: #7f8c8d;
            font-size: 1.2rem;
            margin-bottom: 40px;
            font-weight: 300;
        }

        .search-section {
            margin-bottom: 30px;
        }

        .city-input {
            width: 100%;
            padding: 18px 20px;
            border: 2px solid #e0e0e0;
            border-radius: 15px;
            font-size: 1.1rem;
            margin-bottom: 20px;
            transition: all 0.3s ease;
            background: white;
            box-shadow: 0 2px 10px rgba(0,0,0,0.05);
        }

        .city-input:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 0 4px rgba(102, 126, 234, 0.15);
            transform: translateY(-2px);
        }

        .get-recommendations {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 18px 30px;
            border-radius: 15px;
            font-size: 1.2rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            width: 100%;
            box-shadow: 0 4px 15px rgba(102, 126, 234, 0.3);
        }

        .get-recommendations:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 25px rgba(102, 126, 234, 0.4);
        }

        .get-recommendations:active {
            transform: translateY(-1px);
        }

        .get-recommendations:disabled {
            opacity: 0.6;
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }

        /* Кнопки действий */
        .buttons {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
            gap: 12px;
        }

        .geo-btn {
            background: linear-gradient(135deg, #16a085 0%, #1abc9c 100%);
            color: white;
            border: none;
            padding: 18px 30px;
            border-radius: 15px;
            font-size: 1.1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            width: 100%;
            box-shadow: 0 4px 15px rgba(26, 188, 156, 0.3);
        }

        .geo-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 25px rgba(26, 188, 156, 0.4);
        }

        .geo-btn:active {
            transform: translateY(-1px);
        }

        .geo-btn:disabled {
            opacity: 0.6;
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }

        .loading {
            display: none;
            margin: 30px 0;
            animation: fadeIn 0.5s ease;
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        .spinner {
            border: 4px solid #f3f3f3;
            border-top: 4px solid #667eea;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
            margin: 0 auto 15px;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .results {
            display: none;
            margin-top: 30px;
            padding: 30px;
            background: rgba(255, 255, 255, 0.9);
            border-radius: 20px;
            border: 1px solid rgba(255, 255, 255, 0.3);
            animation: fadeInUp 0.6s ease;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
        }

        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .weather-info {
            display: grid;
            grid-template-columns: 1fr auto;
            gap: 25px;
            align-items: center;
            margin-bottom: 30px;
        }

        .weather-details {
            text-align: left;
        }

        .temperature {
            font-size: 3rem;
            font-weight: 700;
            color: #2c3e50;
            margin-bottom: 8px;
            text-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }

        .city-name {
            font-size: 1.4rem;
            color: #7f8c8d;
            margin-bottom: 12px;
            font-weight: 500;
        }

        .weather-description {
            color: #34495e;
            font-size: 1.2rem;
            text-transform: capitalize;
            font-weight: 500;
        }

        .weather-icon {
            font-size: 5rem;
            color: #f39c12;
            text-shadow: 0 4px 8px rgba(0,0,0,0.1);
            animation: weatherFloat 3s ease-in-out infinite;
        }

        @keyframes weatherFloat {
            0%, 100% { transform: translateY(0px); }
            50% { transform: translateY(-10px); }
        }

        .recommendation {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 25px;
            border-radius: 15px;
            margin-bottom: 20px;
            box-shadow: 0 8px 25px rgba(102, 126, 234, 0.3);
            animation: slideInUp 0.8s ease 0.2s both;
        }

        @keyframes slideInUp {
            from {
                opacity: 0;
                transform: translateY(30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .recommendation h3 {
            margin-bottom: 15px;
            font-size: 1.3rem;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .recommendation p {
            line-height: 1.7;
            font-size: 1.1rem;
        }

        .error {
            background: linear-gradient(135deg, #e74c3c 0%, #c0392b 100%);
            color: white;
            padding: 20px;
            border-radius: 15px;
            margin-top: 20px;
            animation: shake 0.5s ease;
            box-shadow: 0 4px 15px rgba(231, 76, 60, 0.3);
        }

        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            25% { transform: translateX(-5px); }
            75% { transform: translateX(5px); }
        }

        .weather-stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(140px, 1fr));
            gap: 20px;
            margin-top: 25px;
        }

        .stat {
            background: rgba(255, 255, 255, 0.95);
            padding: 20px;
            border-radius: 15px;
            text-align: center;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
            transition: transform 0.3s ease;
            border: 1px solid rgba(255, 255, 255, 0.3);
        }

        .stat:hover {
            transform: translateY(-5px);
        }

        .stat-value {
            font-size: 1.8rem;
            font-weight: 700;
            color: #2c3e50;
            margin-bottom: 5px;
        }

        .stat-label {
            font-size: 1rem;
            color: #7f8c8d;
            font-weight: 500;
        }

        .api-warning {
            background: linear-gradient(135deg, #f39c12 0%, #e67e22 100%);
            color: white;
            padding: 15px;
            border-radius: 12px;
            margin-bottom: 20px;
            font-size: 0.95rem;
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.8; }
        }

        .api-warning a {
            color: white;
            text-decoration: underline;
            font-weight: 600;
        }

        @media (max-width: 480px) {
            .container {
                padding: 25px;
                margin: 10px;
            }
            
            h1 {
                font-size: 2.2rem;
            }
            
            .weather-info {
                grid-template-columns: 1fr;
                text-align: center;
                gap: 15px;
            }
            
            .weather-details {
                text-align: center;
            }

            .temperature {
                font-size: 2.5rem;
            }

            .weather-icon {
                font-size: 4rem;
            }

            .weather-stats {
                grid-template-columns: 1fr 1fr;
                gap: 15px;
            }
        }

        @media (max-width: 360px) {
            .weather-stats {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <h1><i class="fas fa-cloud-sun"></i> WeatherWear</h1>
        <p class="subtitle">Умный гардероб для любой погоды</p>
        
        <div id="apiWarning" class="api-warning" style="display: none;">
            <i class="fas fa-exclamation-triangle"></i>
            Для работы приложения необходим API ключ WeatherAPI.com. 
            <a href="https://www.weatherapi.com/" target="_blank">Получить бесплатный ключ</a>
        </div>
        
        <div class="search-section">
            <input 
                type="text" 
                class="city-input" 
                id="cityInput" 
                placeholder="Введите название города..."
                list="cities"
                autocomplete="off"
            >
            <datalist id="cities">
                <option value="Москва">
                <option value="Санкт-Петербург">
                <option value="Новосибирск">
                <option value="Екатеринбург">
                <option value="Казань">
                <option value="Нижний Новгород">
                <option value="Челябинск">
                <option value="Самара">
                <option value="Уфа">
                <option value="Ростов-на-Дону">
                <option value="Красноярск">
                <option value="Пермь">
                <option value="Воронеж">
                <option value="Волгоград">
                <option value="Краснодар">
                <option value="Саратов">
                <option value="Тюмень">
                <option value="Тольятти">
                <option value="Ижевск">
                <option value="Барнаул">
                <option value="Ульяновск">
            </datalist>
            
            <div class="buttons">
                <button class="get-recommendations" id="getRecommendations">
                    <i class="fas fa-search"></i> Получить рекомендации
                </button>
                <button class="geo-btn" id="useGeolocation">
                    <i class="fas fa-location-crosshairs"></i> Определить по геолокации
                </button>
            </div>
        </div>
        
        <div class="loading" id="loading">
            <div class="spinner"></div>
            <p>Получаем данные о погоде...</p>
        </div>
        
        <div class="results" id="results">
            <div class="weather-info">
                <div class="weather-details">
                    <div class="temperature" id="temperature"></div>
                    <div class="city-name" id="cityName"></div>
                    <div class="weather-description" id="weatherDescription"></div>
                </div>
                <div class="weather-icon" id="weatherIcon"></div>
            </div>
            
            <div class="weather-stats">
                <div class="stat">
                    <div class="stat-value" id="feelsLike"></div>
                    <div class="stat-label">Ощущается как</div>
                </div>
                <div class="stat">
                    <div class="stat-value" id="windSpeed"></div>
                    <div class="stat-label">Ветер (м/с)</div>
                </div>
                <div class="stat">
                    <div class="stat-value" id="humidity"></div>
                    <div class="stat-label">Влажность (%)</div>
                </div>
                <div class="stat">
                    <div class="stat-value" id="pressure"></div>
                    <div class="stat-label">Давление (мм)</div>
                </div>
            </div>
            
            <div class="recommendation" id="recommendation">
                <h3><i class="fas fa-tshirt"></i> Рекомендации по одежде</h3>
                <p id="recommendationText"></p>
            </div>
        </div>
    </div>

    <script>
        // Используем бесплатный API WeatherAPI.com (не требует регистрации для базового использования)
        const API_BASE_URL = 'https://api.weatherapi.com/v1/current.json';
        const API_KEY = '837c5b79fc564c3fb14100703251108'; // Получите бесплатный ключ на https://www.weatherapi.com/
        
        const cityInput = document.getElementById('cityInput');
        const getRecommendationsBtn = document.getElementById('getRecommendations');
        const useGeolocationBtn = document.getElementById('useGeolocation');
        const loading = document.getElementById('loading');
        const results = document.getElementById('results');
        const apiWarning = document.getElementById('apiWarning');
        
        // Показываем предупреждение об API, если ключ не установлен
        if (API_KEY === 'YOUR_API_KEY_HERE') {
            apiWarning.style.display = 'block';
            apiWarning.innerHTML = `
                <i class="fas fa-exclamation-triangle"></i>
                Для работы приложения необходим API ключ WeatherAPI.com. 
                <a href="https://www.weatherapi.com/" target="_blank">Получить бесплатный ключ</a>
            `;
        }
        
        // Загрузка последнего города из localStorage
        const lastCity = localStorage.getItem('lastCity');
        if (lastCity) {
            cityInput.value = lastCity;
        }
        
        // Обработчик клика по кнопке
        getRecommendationsBtn.addEventListener('click', getWeatherRecommendations);
        
        // Обработчик Enter в поле ввода
        cityInput.addEventListener('keypress', function(e) {
            if (e.key === 'Enter') {
                getWeatherRecommendations();
            }
        });

        // Обработчик изменения в поле ввода
        cityInput.addEventListener('input', function() {
            if (this.value.trim()) {
                getRecommendationsBtn.disabled = false;
            } else {
                getRecommendationsBtn.disabled = true;
            }
        });
        
        async function getWeatherRecommendations() {
            const city = cityInput.value.trim();
            if (!city) {
                showError('Пожалуйста, введите название города');
                return;
            }
            await fetchWeather(city, { persistCity: true });
        }

        async function fetchWeather(query, options = { persistCity: false }) {
            // Если ключа нет, отображаем предупреждение (обрабатывается выше для 'YOUR_API_KEY_HERE')
            showLoading(true);
            try {
                const url = `${API_BASE_URL}?key=${API_KEY}&q=${encodeURIComponent(query)}&aqi=no&lang=ru`;
                const response = await fetch(url);
                if (!response.ok) {
                    if (response.status === 400) {
                        throw new Error('Локация не найдена. Уточните запрос');
                    } else if (response.status === 401) {
                        throw new Error('Неверный API ключ. Проверьте настройки');
                    } else {
                        throw new Error('Ошибка получения данных о погоде');
                    }
                }
                const data = await response.json();
                if (options.persistCity && typeof query === 'string' && isNaN(Number(query))) {
                    localStorage.setItem('lastCity', query);
                }
                displayWeatherData(data);
                generateRecommendations(data);
            } catch (error) {
                showError('Ошибка: ' + error.message);
            } finally {
                showLoading(false);
            }
        }

        // Геолокация для повышения точности (используем координаты)
        useGeolocationBtn.addEventListener('click', function() {
            if (!navigator.geolocation) {
                showError('Геолокация не поддерживается вашим браузером');
                return;
            }
            showLoading(true);
            navigator.geolocation.getCurrentPosition(
                async (position) => {
                    const latitude = position.coords.latitude.toFixed(5);
                    const longitude = position.coords.longitude.toFixed(5);
                    await fetchWeather(`${latitude},${longitude}`);
                },
                (err) => {
                    showError('Не удалось получить геопозицию: ' + err.message);
                    showLoading(false);
                },
                { enableHighAccuracy: true, timeout: 10000, maximumAge: 60000 }
            );
        });
        
        function displayWeatherData(data) {
            const temp = Math.round(data.current.temp_c);
            const feelsLike = Math.round(data.current.feelslike_c);
            const windSpeed = Math.round(data.current.wind_kph / 3.6 * 10) / 10; // конвертация км/ч в м/с
            const humidity = data.current.humidity;
            const pressure = Math.round(data.current.pressure_mb * 0.750062); // конвертация мбар в мм рт.ст.
            const description = data.current.condition.text;
            const locationName = [data.location.name, data.location.region, data.location.country]
                .filter(Boolean)
                .join(', ');
            
            document.getElementById('temperature').textContent = `${temp}°C`;
            document.getElementById('feelsLike').textContent = `${feelsLike}°C`;
            document.getElementById('windSpeed').textContent = `${windSpeed}`;
            document.getElementById('humidity').textContent = `${humidity}`;
            document.getElementById('pressure').textContent = `${pressure}`;
            document.getElementById('weatherDescription').textContent = description;
            document.getElementById('cityName').textContent = locationName;
            
            // Устанавливаем иконку погоды
            const weatherIcon = document.getElementById('weatherIcon');
            const weatherCode = data.current.condition.code;
            
            // Маппинг кодов погоды на иконки
            const weatherIcons = {
                1000: '<i class="fas fa-sun"></i>', // Ясно
                1003: '<i class="fas fa-cloud-sun"></i>', // Переменная облачность
                1006: '<i class="fas fa-cloud"></i>', // Облачно
                1009: '<i class="fas fa-cloud"></i>', // Пасмурно
                1030: '<i class="fas fa-smog"></i>', // Туман
                1063: '<i class="fas fa-cloud-rain"></i>', // Небольшой дождь
                1066: '<i class="fas fa-snowflake"></i>', // Небольшой снег
                1069: '<i class="fas fa-cloud-rain"></i>', // Мокрый снег
                1087: '<i class="fas fa-bolt"></i>', // Гроза
                1114: '<i class="fas fa-snowflake"></i>', // Снег
                1117: '<i class="fas fa-snowflake"></i>', // Снежная буря
                1135: '<i class="fas fa-smog"></i>', // Туман
                1147: '<i class="fas fa-smog"></i>', // Ледяной туман
                1150: '<i class="fas fa-cloud-rain"></i>', // Морось
                1153: '<i class="fas fa-cloud-rain"></i>', // Легкая морось
                1168: '<i class="fas fa-cloud-rain"></i>', // Ледяная морось
                1171: '<i class="fas fa-cloud-rain"></i>', // Сильная ледяная морось
                1180: '<i class="fas fa-cloud-rain"></i>', // Небольшой дождь
                1183: '<i class="fas fa-cloud-rain"></i>', // Легкий дождь
                1186: '<i class="fas fa-cloud-rain"></i>', // Умеренный дождь
                1189: '<i class="fas fa-cloud-rain"></i>', // Сильный дождь
                1192: '<i class="fas fa-cloud-showers-heavy"></i>', // Очень сильный дождь
                1195: '<i class="fas fa-cloud-showers-heavy"></i>', // Экстремальный дождь
                1198: '<i class="fas fa-cloud-rain"></i>', // Ледяной дождь
                1201: '<i class="fas fa-cloud-rain"></i>', // Сильный ледяной дождь
                1204: '<i class="fas fa-cloud-rain"></i>', // Мокрый снег
                1207: '<i class="fas fa-cloud-rain"></i>', // Сильный мокрый снег
                1210: '<i class="fas fa-snowflake"></i>', // Небольшой снег
                1213: '<i class="fas fa-snowflake"></i>', // Легкий снег
                1216: '<i class="fas fa-snowflake"></i>', // Умеренный снег
                1219: '<i class="fas fa-snowflake"></i>', // Сильный снег
                1222: '<i class="fas fa-snowflake"></i>', // Очень сильный снег
                1225: '<i class="fas fa-snowflake"></i>', // Экстремальный снег
                1237: '<i class="fas fa-snowflake"></i>', // Ледяной дождь
                1240: '<i class="fas fa-cloud-rain"></i>', // Легкий дождь
                1243: '<i class="fas fa-cloud-rain"></i>', // Умеренный дождь
                1246: '<i class="fas fa-cloud-showers-heavy"></i>', // Сильный дождь
                1249: '<i class="fas fa-cloud-rain"></i>', // Легкий мокрый снег
                1252: '<i class="fas fa-cloud-rain"></i>', // Сильный мокрый снег
                1255: '<i class="fas fa-snowflake"></i>', // Легкий снег
                1258: '<i class="fas fa-snowflake"></i>', // Сильный снег
                1261: '<i class="fas fa-snowflake"></i>', // Ледяной дождь
                1264: '<i class="fas fa-snowflake"></i>', // Сильный ледяной дождь
                1273: '<i class="fas fa-bolt"></i>', // Гроза с дождем
                1276: '<i class="fas fa-bolt"></i>' // Гроза со снегом
            };
            
            weatherIcon.innerHTML = weatherIcons[weatherCode] || '<i class="fas fa-cloud"></i>';
            
            // Меняем фон в зависимости от температуры
            changeBackground(temp);
            
            results.style.display = 'block';
        }
        
        function generateRecommendations(data) {
            const temp = data.current.temp_c;
            const windSpeed = data.current.wind_kph / 3.6; // конвертация в м/с
            const humidity = data.current.humidity;
            const weatherDescription = data.current.condition.text.toLowerCase();
            
            let baseRecommendation = '';
            let reasoning = '';
            
            // Базовые рекомендации по температуре
            if (temp < -15) {
                baseRecommendation = 'Пуховик, термобелье, шапка, варежки, шарф';
                reasoning = 'Очень холодно, нужна максимальная защита от мороза';
            } else if (temp >= -15 && temp < -5) {
                baseRecommendation = 'Зимняя куртка, теплая шапка, перчатки';
                reasoning = 'Холодная погода, требуется теплая одежда';
            } else if (temp >= -5 && temp < 5) {
                baseRecommendation = 'Зимняя куртка, шарф, теплая обувь';
                reasoning = 'Прохладная погода, нужна зимняя одежда';
            } else if (temp >= 5 && temp < 15) {
                baseRecommendation = 'Ветровка + свитер, джинсы';
                reasoning = 'Прохладная погода, нужен дополнительный слой';
            } else if (temp >= 15 && temp < 25) {
                baseRecommendation = 'Легкая куртка или рубашка';
                reasoning = 'Комфортная температура, легкая одежда';
            } else {
                baseRecommendation = 'Футболка, шорты или сарафан';
                reasoning = 'Теплая погода, легкая одежда';
            }
            
            // Корректировки по ветру
            if (windSpeed > 8) {
                baseRecommendation += ', ветровка или пальто';
                reasoning += '. Сильный ветер требует дополнительной защиты';
            } else if (windSpeed > 5) {
                baseRecommendation += ', легкая куртка';
                reasoning += '. Ветреная погода';
            }
            
            // Корректировки по влажности
            if (humidity > 80) {
                baseRecommendation += ', непромокаемая обувь';
                reasoning += '. Высокая влажность';
            }
            
            // Корректировки по осадкам
            if (weatherDescription.includes('дождь') || weatherDescription.includes('rain')) {
                baseRecommendation += ', непромокаемая обувь, зонт';
                reasoning += '. Ожидается дождь';
            } else if (weatherDescription.includes('снег') || weatherDescription.includes('snow')) {
                baseRecommendation += ', непромокаемая обувь';
                reasoning += '. Ожидается снег';
            } else if (weatherDescription.includes('туман') || weatherDescription.includes('fog')) {
                baseRecommendation += ', светоотражающие элементы';
                reasoning += '. Туманная погода';
            }
            
            const recommendationText = `Для прогулки 30-60 мин: ${baseRecommendation}. ${reasoning}`;
            document.getElementById('recommendationText').textContent = recommendationText;
        }
        
        function changeBackground(temp) {
            const body = document.body;
            body.className = ''; // Убираем все классы
            
            if (temp < -10) {
                body.classList.add('cold');
            } else if (temp < 5) {
                body.classList.add('cool');
            } else if (temp < 20) {
                body.classList.add('mild');
            } else if (temp < 30) {
                body.classList.add('warm');
            } else {
                body.classList.add('hot');
            }
        }
        
        function showLoading(show) {
            loading.style.display = show ? 'block' : 'none';
            getRecommendationsBtn.disabled = show;
            if (show) {
                results.style.display = 'none';
            }
        }
        
        function showError(message) {
            const errorDiv = document.createElement('div');
            errorDiv.className = 'error';
            errorDiv.innerHTML = `<i class="fas fa-exclamation-triangle"></i> ${message}`;
            
            // Удаляем предыдущие ошибки
            const existingError = document.querySelector('.error');
            if (existingError) {
                existingError.remove();
            }
            
            document.querySelector('.container').appendChild(errorDiv);
            
            // Автоматически удаляем ошибку через 6 секунд
            setTimeout(() => {
                if (errorDiv.parentNode) {
                    errorDiv.remove();
                }
            }, 6000);
        }

        // Инициализация состояния кнопки
        if (!cityInput.value.trim()) {
            getRecommendationsBtn.disabled = true;
        }
    </script>
</body>
</html>
